<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="board">
	<select id="selectBoardList" parameterType="map" resultType="board">
	select *
		from(
			select rownum as rnum, b.* from
				(select
					board_no as boardNo,
					board_title as boardTitle,
					board_content as boardContent,
					board_writer as boardWriter,
					board_date as boardDate
				from board 
					<if test="type!=null">
						<if test="type.equals('boardTitle')"> 
							where board_title like '%'||#{keyword}||'%'
						</if>
						<if test="type.equals('boardWriter')">
							where board_writer like '%'||#{keyword}||'%'
						</if>
					</if>
				order by board_no desc)b
			)where rnum between #{start} and #{end}
	</select>
	<select id="oneContent" parameterType="_int" resultType="board">
		select
			board_no as boardNo,
			board_title as boardTitle,
			board_content as boardContent,
			board_writer as boardWriter,
			board_date as boardDate	
		from board
		where board_no = #{boardNo}
	</select>
	<delete id="boardDelete" parameterType="board">
		delete from board where board_no = #{boardNo} and board_pw = #{boardPw}
	</delete>
	<insert id="boardWrite" parameterType="board">
		insert into board values(
			board_seq.nextval,
			#{boardTitle},
			#{boardContent},
			#{boardWriter},
			sysdate,
			#{boardPw}
		)
	</insert>
	<update id="boardUpdate" parameterType="board">
		update board
		set
			board_title = #{boardTitle},
			board_content = #{boardContent}
		where board_no = #{boardNo}
		
	</update>
	<select id="boardUpdateFrm" parameterType="_int" resultType="board">
		select
			board_no as boardNo,
			board_title as boardTitle,
			board_content as boardContent,
			board_writer as boardWriter,
			board_date as boardDate
		from board
		where board_no = #{boardNo}
	</select>
	<select id="selectMapperInfoCount" parameterType="map" resultType="int">
		select count(*) from board
		<if test="type!=null">
			<if test="type.equals('boardTitle')">
				where board_title like '%'||#{keyword}||'%'
			</if>
			<if test="type.equals('boardWriter')">
				where board_writer like '%'||#{keyword}||'%'
			</if>
		</if>
	</select>
	<select id="pwCheck" parameterType="board" resultType="board">
		select
			board_no as boardNo,
			board_pw as boardPw
		from board
		where board_no=#{boardNo} and board_pw=#{boardPw}
	</select>
		<insert id="boardCommentInsert" parameterType="comment">
		insert into board_comment values(
			seq_board_comment.nextval
			, #{boardCommentLevel}
			, #{boardCommentWriter}
			, #{boardCommentContent}
			, #{boardRef}
			, #{boardCommentRef}
			, sysdate
			, #{boardCommentPw}
		)
	</insert>
	<select id="selectCommentList" parameterType="_int" resultType="comment">
		select
			board_comment_no as boardCommentNo
			, board_comment_level as boardCommentLevel
			, board_comment_writer as boardCommentWriter
			, board_comment_content as boardCommentContent
			, board_ref as boardRef
			, board_comment_date as boardCommentDate
		from board_comment where board_ref = #{boardNo} order by board_comment_no
	</select>
	<insert id="replyInsert" parameterType="replyVo">
		insert into board_reply values(
			seq_board_reply.nextval
			, #{boardReplyLevel}
			, #{boardReplyWriter}
			, #{boardReplyContent}
			, #{boardRef}
			, #{boardReplyRef}
			, sysdate
			, #{boardReplyPw}
			)
	</insert>
	<select id="boardOneComment" parameterType="_int" resultType="comment">
		select rownum as rnum, b.* 
			from(select
					board_comment_no as boardCommentNo
					, board_comment_level as boardCommentLevel
					, board_comment_writer as boardCommentWriter
					, board_comment_content as boardCommentContent
					, board_ref as boardRef
					, board_comment_date as boardCommentDate
				from board_comment where board_ref = #{boardNo} order by board_comment_no desc)b where rownum = 1
	</select>
	<select id="commentPwCheck" parameterType="comment">
		select
			board_comment_no as boardCommentNo
			, board_comment_pw as boardCommentPw
		from board_comment
		where board_comment_no=#{boardCommentNo} and board_comment_pw=#{boardCommentPw}
	</select>
	<delete id="deleteComment" parameterType="comment">
		delete from board_comment where board_comment_no = #{boardCommentNo} and board_comment_pw = #{boardCommentPw}
	</delete>
  
</mapper>
